var e=require("react"),r=require("./index.production.js");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("@grafana/data"),require("react-inlinesvg"),require("react-dom"),require("tty"),require("util"),require("@grafana/e2e-selectors"),require("moment"),require("@grafana/schema"),require("jquery"),require("@grafana/aws-sdk");var t=n(e);function o(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function i(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function a(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?i(Object(n),!0).forEach((function(r){o(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function u(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function c(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function s(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function l(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?s(Object(n),!0).forEach((function(r){c(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function p(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return function(e){return r.reduceRight((function(e,r){return r(e)}),e)}}function f(e){return function r(){for(var n=this,t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return o.length>=e.length?e.apply(this,o):function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r.apply(n,[].concat(o,t))}}}function d(e){return{}.toString.call(e).includes("Object")}function g(e){return"function"==typeof e}var y=f((function(e,r){throw new Error(e[r]||e.default)}))({initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"}),h={changes:function(e,r){return d(r)||y("changeType"),Object.keys(r).some((function(r){return n=e,t=r,!Object.prototype.hasOwnProperty.call(n,t);var n,t}))&&y("changeField"),r},selector:function(e){g(e)||y("selectorType")},handler:function(e){g(e)||d(e)||y("handlerType"),d(e)&&Object.values(e).some((function(e){return!g(e)}))&&y("handlersType")},initial:function(e){var r;e||y("initialIsRequired"),d(e)||y("initialType"),r=e,Object.keys(r).length||y("initialContent")}};function v(e,r){return g(r)?r(e.current):r}function b(e,r){return e.current=l(l({},e.current),r),r}function m(e,r,n){return g(r)?r(e.current):Object.keys(n).forEach((function(n){var t;return null===(t=r[n])||void 0===t?void 0:t.call(r,e.current[n])})),n}var P={create:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};h.initial(e),h.handler(r);var n={current:e},t=f(m)(n,r),o=f(b)(n),i=f(h.changes)(e),a=f(v)(n);function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return h.selector(e),e(n.current)}function c(e){p(t,o,i,a)(e)}return[u,c]}};var T,w={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "},j=(T=function(e,r){throw new Error(e[r]||e.default)},function e(){for(var r=this,n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];return t.length>=T.length?T.apply(this,t):function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e.apply(r,[].concat(t,o))}})(w),O={config:function(e){var r;return e||j("configIsRequired"),r=e,{}.toString.call(r).includes("Object")||j("configType"),e.urls?(console.warn(w.deprecation),{paths:{vs:e.urls.monacoBase}}):e}};function k(e,r){return Object.keys(r).forEach((function(n){r[n]instanceof Object&&e[n]&&Object.assign(r[n],k(e[n],r[n]))})),a(a({},e),r)}var M={type:"cancelation",msg:"operation is manually canceled"};function E(e){var r=!1,n=new Promise((function(n,t){e.then((function(e){return r?t(M):n(e)})),e.catch(t)}));return n.cancel=function(){return r=!0},n}var S,q,R=P.create({config:{paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.28.1/min/vs"}},isInitialized:!1,resolve:null,reject:null,monaco:null}),C=(q=2,function(e){if(Array.isArray(e))return e}(S=R)||function(e,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],t=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(t=(a=u.next()).done)&&(n.push(a.value),!r||n.length!==r);t=!0);}catch(e){o=!0,i=e}finally{try{t||null==u.return||u.return()}finally{if(o)throw i}}return n}}(S,q)||function(e,r){if(e){if("string"==typeof e)return u(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,r):void 0}}(S,q)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),I=C[0],V=C[1];function A(e){return document.body.appendChild(e)}function z(e){var r,n,t=I((function(e){return{config:e.config,reject:e.reject}})),o=(r="".concat(t.config.paths.vs,"/loader.js"),n=document.createElement("script"),r&&(n.src=r),n);return o.onload=function(){return e()},o.onerror=t.reject,o}function D(){var e=I((function(e){return{config:e.config,resolve:e.resolve,reject:e.reject}})),r=window.require;r.config(e.config),r(["vs/editor/editor.main"],(function(r){N(r),e.resolve(r)}),(function(r){e.reject(r)}))}function N(e){I().monaco||V({monaco:e})}var _=new Promise((function(e,r){return V({resolve:e,reject:r})})),x={config:function(e){V((function(r){return{config:k(r.config,O.config(e))}}))},init:function(){if(!I((function(e){return{isInitialized:e.isInitialized}})).isInitialized){if(window.monaco&&window.monaco.editor)return N(window.monaco),E(Promise.resolve(window.monaco));!function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return function(e){return r.reduceRight((function(e,r){return r(e)}),e)}}(A,z)(D),V({isInitialized:!0})}return E(_)},__getMonacoInstance:function(){return I((function(e){return e.monaco}))}};function B(){return B=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},B.apply(this,arguments)}const L={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};function F({content:e}){return t.default.createElement("div",{style:L},e)}const U={display:"flex",position:"relative",textAlign:"initial"},Y={width:"100%"},$={display:"none"};function G({width:e,height:r,isEditorReady:n,loading:o,_ref:i,className:a,wrapperProps:u}){return t.default.createElement("section",B({style:{...U,width:e,height:r}},u),!n&&t.default.createElement(F,{content:o}),t.default.createElement("div",{ref:i,style:{...Y,...!n&&$},className:a}))}G.propTypes={width:r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string]).isRequired,height:r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string]).isRequired,loading:r.PropTypes.oneOfType([r.PropTypes.element,r.PropTypes.string]).isRequired,isEditorReady:r.PropTypes.bool.isRequired,className:r.PropTypes.string,wrapperProps:r.PropTypes.object};var H=e.memo(G);function J(r){e.useEffect(r,[])}function K(r,n,t=!0){const o=e.useRef(!0);e.useEffect(o.current||!t?()=>{o.current=!1}:r,n)}function Q(){}function W(e,r,n,t){return function(e,r){return e.editor.getModel(X(e,r))}(e,t)||function(e,r,n,t){return e.editor.createModel(r,n,t&&X(e,t))}(e,r,n,t)}function X(e,r){return e.Uri.parse(r)}r.PropTypes.string,r.PropTypes.string,r.PropTypes.string,r.PropTypes.string,r.PropTypes.string,r.PropTypes.string,r.PropTypes.string,r.PropTypes.bool,r.PropTypes.bool,r.PropTypes.string,r.PropTypes.oneOfType([r.PropTypes.element,r.PropTypes.string]),r.PropTypes.object,r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string]),r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string]),r.PropTypes.string,r.PropTypes.object,r.PropTypes.func,r.PropTypes.func;const Z=new Map;function ee({defaultValue:r,defaultLanguage:n,defaultPath:o,value:i,language:a,path:u,theme:c,line:s,loading:l,options:p,overrideServices:f,saveViewState:d,keepCurrentModel:g,width:y,height:h,className:v,wrapperProps:b,beforeMount:m,onMount:P,onChange:T,onValidate:w}){const[j,O]=e.useState(!1),[k,M]=e.useState(!0),E=e.useRef(null),S=e.useRef(null),q=e.useRef(null),R=e.useRef(P),C=e.useRef(m),I=e.useRef(null),V=e.useRef(i),A=function(r){const n=e.useRef();return e.useEffect((()=>{n.current=r}),[r]),n.current}(u);J((()=>{const e=x.init();return e.then((e=>(E.current=e)&&M(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&console.error("Monaco initialization: error:",e))),()=>S.current?function(){var e,r;null===(e=I.current)||void 0===e||e.dispose(),g?d&&Z.set(u,S.current.saveViewState()):null===(r=S.current.getModel())||void 0===r||r.dispose();S.current.dispose()}():e.cancel()})),K((()=>{const e=W(E.current,r||i,n||a,u);e!==S.current.getModel()&&(d&&Z.set(A,S.current.saveViewState()),S.current.setModel(e),d&&S.current.restoreViewState(Z.get(u)))}),[u],j),K((()=>{S.current.updateOptions(p)}),[p],j),K((()=>{S.current.getOption(E.current.editor.EditorOption.readOnly)?S.current.setValue(i):i!==S.current.getValue()&&(S.current.executeEdits("",[{range:S.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),S.current.pushUndoStop())}),[i],j),K((()=>{E.current.editor.setModelLanguage(S.current.getModel(),a)}),[a],j),K((()=>{void 0!==s&&S.current.revealLine(s)}),[s],j),K((()=>{E.current.editor.setTheme(c)}),[c],j);const z=e.useCallback((()=>{C.current(E.current);const e=u||o,t=W(E.current,i||r,n||a,e);S.current=E.current.editor.create(q.current,{model:t,automaticLayout:!0,...p},f),d&&S.current.restoreViewState(Z.get(e)),E.current.editor.setTheme(c),O(!0)}),[r,n,o,i,a,u,p,f,d,c]);return e.useEffect((()=>{j&&R.current(S.current,E.current)}),[j]),e.useEffect((()=>{!k&&!j&&z()}),[k,j,z]),V.current=i,e.useEffect((()=>{var e,r;j&&T&&(null===(e=I.current)||void 0===e||e.dispose(),I.current=null===(r=S.current)||void 0===r?void 0:r.onDidChangeModelContent((e=>{const r=S.current.getValue();V.current!==r&&T(r,e)})))}),[j,T]),e.useEffect((()=>{if(j){const e=E.current.editor.onDidChangeMarkers((e=>{var r;const n=null===(r=S.current.getModel())||void 0===r?void 0:r.uri;if(n){if(e.find((e=>e.path===n.path))){const e=E.current.editor.getModelMarkers({resource:n});null==w||w(e)}}}));return()=>{null==e||e.dispose()}}}),[j,w]),t.default.createElement(H,{width:y,height:h,isEditorReady:j,loading:l,_ref:q,className:v,wrapperProps:b})}ee.propTypes={defaultValue:r.PropTypes.string,defaultPath:r.PropTypes.string,defaultLanguage:r.PropTypes.string,value:r.PropTypes.string,language:r.PropTypes.string,path:r.PropTypes.string,theme:r.PropTypes.string,line:r.PropTypes.number,loading:r.PropTypes.oneOfType([r.PropTypes.element,r.PropTypes.string]),options:r.PropTypes.object,overrideServices:r.PropTypes.object,saveViewState:r.PropTypes.bool,keepCurrentModel:r.PropTypes.bool,width:r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string]),height:r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string]),className:r.PropTypes.string,wrapperProps:r.PropTypes.object,beforeMount:r.PropTypes.func,onMount:r.PropTypes.func,onChange:r.PropTypes.func,onValidate:r.PropTypes.func},ee.defaultProps={theme:"light",loading:"Loading...",options:{},overrideServices:{},saveViewState:!0,keepCurrentModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:Q,onMount:Q,onValidate:Q};var re=e.memo(ee);function ne(e,r){const n=function(e){return void 0===e?{}:{"editor.background":e.components.input.background,"minimap.background":e.colors.background.secondary}}(r);e.editor.defineTheme("grafana-dark",{base:"vs-dark",inherit:!0,colors:n,rules:[{token:"predefined",foreground:null==r?void 0:r.visualization.getColorByName("purple")},{token:"operator",foreground:null==r?void 0:r.visualization.getColorByName("orange")},{token:"tag",foreground:null==r?void 0:r.visualization.getColorByName("green")}]}),e.editor.defineTheme("grafana-light",{base:"vs",inherit:!0,colors:n,rules:[{token:"predefined",foreground:null==r?void 0:r.visualization.getColorByName("purple")},{token:"operator",foreground:null==r?void 0:r.visualization.getColorByName("orange")},{token:"tag",foreground:null==r?void 0:r.visualization.getColorByName("green")}]})}let te=!1;exports.ReactMonacoEditor=n=>{const o=r.useTheme2(),i=function(){const[r,n]=e.useState(x.__getMonacoInstance());return J((()=>{let e;return r||(e=x.init(),e.then((e=>{n(e)}))),()=>{var r;return null===(r=e)||void 0===r?void 0:r.cancel()}})),r}();var a;e.useEffect((()=>{null!==i&&ne(i,o)}),[i,o]),te||(x.config({paths:{vs:(null!==(a=window.__grafana_public_path__)&&void 0!==a?a:"public/")+"lib/monaco/min/vs"}}),te=!0,x.init().then((e=>{ne(e)})));const u=o.isDark?"grafana-dark":"grafana-light";return t.default.createElement(re,Object.assign({theme:u},n))};
//# sourceMappingURL=ReactMonacoEditor.production.js.map
