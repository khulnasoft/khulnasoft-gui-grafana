var e=require("react"),r=require("./index.production.js");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("@grafana/data"),require("@emotion/react"),require("@emotion/css"),require("react-inlinesvg"),require("react-dom"),require("tty"),require("util"),require("supports-color"),require("@grafana/e2e-selectors"),require("moment"),require("@grafana/schema"),require("jquery");var n=t(e);function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function a(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?i(Object(t),!0).forEach((function(r){o(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function u(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function s(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function c(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function p(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?c(Object(t),!0).forEach((function(r){s(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function l(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(e){return r.reduceRight((function(e,r){return r(e)}),e)}}function d(e){return function r(){for(var t=this,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.length>=e.length?e.apply(this,o):function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return r.apply(t,[].concat(o,n))}}}function f(e){return{}.toString.call(e).includes("Object")}function g(e){return"function"==typeof e}var y=d((function(e,r){throw new Error(e[r]||e.default)}))({initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"}),h={changes:function(e,r){return f(r)||y("changeType"),Object.keys(r).some((function(r){return t=e,n=r,!Object.prototype.hasOwnProperty.call(t,n);var t,n}))&&y("changeField"),r},selector:function(e){g(e)||y("selectorType")},handler:function(e){g(e)||f(e)||y("handlerType"),f(e)&&Object.values(e).some((function(e){return!g(e)}))&&y("handlersType")},initial:function(e){var r;e||y("initialIsRequired"),f(e)||y("initialType"),r=e,Object.keys(r).length||y("initialContent")}};function v(e,r){return g(r)?r(e.current):r}function m(e,r){return e.current=p(p({},e.current),r),r}function b(e,r,t){return g(r)?r(e.current):Object.keys(t).forEach((function(t){var n;return null===(n=r[t])||void 0===n?void 0:n.call(r,e.current[t])})),t}var T={create:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};h.initial(e),h.handler(r);var t={current:e},n=d(b)(t,r),o=d(m)(t),i=d(h.changes)(e),a=d(v)(t);function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return h.selector(e),e(t.current)}function s(e){l(n,o,i,a)(e)}return[u,s]}};var w,O={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "},x=(w=function(e,r){throw new Error(e[r]||e.default)},function e(){for(var r=this,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return n.length>=w.length?w.apply(this,n):function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return e.apply(r,[].concat(n,o))}})(O),j={config:function(e){var r;return e||x("configIsRequired"),r=e,{}.toString.call(r).includes("Object")||x("configType"),e.urls?(console.warn(O.deprecation),{paths:{vs:e.urls.monacoBase}}):e}};function M(e,r){return Object.keys(r).forEach((function(t){r[t]instanceof Object&&e[t]&&Object.assign(r[t],M(e[t],r[t]))})),a(a({},e),r)}var k={type:"cancelation",msg:"operation is manually canceled"};function P(e){var r=!1,t=new Promise((function(t,n){e.then((function(e){return r?n(k):t(e)})),e.catch(n)}));return t.cancel=function(){return r=!0},t}var E,R,S=T.create({config:{paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.28.1/min/vs"}},isInitialized:!1,resolve:null,reject:null,monaco:null}),C=(R=2,function(e){if(Array.isArray(e))return e}(E=S)||function(e,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(t.push(a.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return t}}(E,R)||function(e,r){if(e){if("string"==typeof e)return u(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?u(e,r):void 0}}(E,R)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),q=C[0],V=C[1];function I(e){return document.body.appendChild(e)}function N(e){var r,t,n=q((function(e){return{config:e.config,reject:e.reject}})),o=(r="".concat(n.config.paths.vs,"/loader.js"),t=document.createElement("script"),r&&(t.src=r),t);return o.onload=function(){return e()},o.onerror=n.reject,o}function L(){var e=q((function(e){return{config:e.config,resolve:e.resolve,reject:e.reject}})),r=window.require;r.config(e.config),r(["vs/editor/editor.main"],(function(r){z(r),e.resolve(r)}),(function(r){e.reject(r)}))}function z(e){q().monaco||V({monaco:e})}var A=new Promise((function(e,r){return V({resolve:e,reject:r})})),D={config:function(e){V((function(r){return{config:M(r.config,j.config(e))}}))},init:function(){if(!q((function(e){return{isInitialized:e.isInitialized}})).isInitialized){if(window.monaco&&window.monaco.editor)return z(window.monaco),P(Promise.resolve(window.monaco));!function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(e){return r.reduceRight((function(e,r){return r(e)}),e)}}(I,N)(L),V({isInitialized:!0})}return P(A)},__getMonacoInstance:function(){return q((function(e){return e.monaco}))}};function _(){return _=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},_.apply(this,arguments)}const B={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};function F({content:e}){return n.default.createElement("div",{style:B},e)}const U={display:"flex",position:"relative",textAlign:"initial"},Y={width:"100%"},$={display:"none"};function G({width:e,height:r,isEditorReady:t,loading:o,_ref:i,className:a,wrapperProps:u}){return n.default.createElement("section",_({style:{...U,width:e,height:r}},u),!t&&n.default.createElement(F,{content:o}),n.default.createElement("div",{ref:i,style:{...Y,...!t&&$},className:a}))}G.propTypes={width:r.propTypes.exports.oneOfType([r.propTypes.exports.number,r.propTypes.exports.string]).isRequired,height:r.propTypes.exports.oneOfType([r.propTypes.exports.number,r.propTypes.exports.string]).isRequired,loading:r.propTypes.exports.oneOfType([r.propTypes.exports.element,r.propTypes.exports.string]).isRequired,isEditorReady:r.propTypes.exports.bool.isRequired,className:r.propTypes.exports.string,wrapperProps:r.propTypes.exports.object};var H=e.memo(G);function J(r){e.useEffect(r,[])}function K(r,t,n=!0){const o=e.useRef(!0);e.useEffect(o.current||!n?()=>{o.current=!1}:r,t)}function Q(){}function W(e,r,t,n){return function(e,r){return e.editor.getModel(X(e,r))}(e,n)||function(e,r,t,n){return e.editor.createModel(r,t,n&&X(e,n))}(e,r,t,n)}function X(e,r){return e.Uri.parse(r)}function Z({original:r,modified:t,language:o,originalLanguage:i,modifiedLanguage:a,originalModelPath:u,modifiedModelPath:s,keepCurrentOriginalModel:c,keepCurrentModifiedModel:p,theme:l,loading:d,options:f,height:g,width:y,className:h,wrapperProps:v,beforeMount:m,onMount:b}){const[T,w]=e.useState(!1),[O,x]=e.useState(!0),j=e.useRef(null),M=e.useRef(null),k=e.useRef(null),P=e.useRef(b),E=e.useRef(m);J((()=>{const e=D.init();return e.then((e=>(M.current=e)&&x(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&console.error("Monaco initialization: error:",e))),()=>j.current?function(){const e=j.current.getModel();var r,t;c||null===(r=e.original)||void 0===r||r.dispose();p||null===(t=e.modified)||void 0===t||t.dispose();j.current.dispose()}():e.cancel()})),K((()=>{const e=j.current.getModifiedEditor();e.getOption(M.current.editor.EditorOption.readOnly)?e.setValue(t):t!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:t,forceMoveMarkers:!0}]),e.pushUndoStop())}),[t],T),K((()=>{j.current.getModel().original.setValue(r)}),[r],T),K((()=>{const{original:e,modified:r}=j.current.getModel();M.current.editor.setModelLanguage(e,i||o),M.current.editor.setModelLanguage(r,a||o)}),[o,i,a],T),K((()=>{M.current.editor.setTheme(l)}),[l],T),K((()=>{j.current.updateOptions(f)}),[f],T);const R=e.useCallback((()=>{E.current(M.current);const e=W(M.current,r,i||o,u),n=W(M.current,t,a||o,s);j.current.setModel({original:e,modified:n})}),[o,t,a,r,i,u,s]),S=e.useCallback((()=>{j.current=M.current.editor.createDiffEditor(k.current,{automaticLayout:!0,...f}),R(),M.current.editor.setTheme(l),w(!0)}),[f,l,R]);return e.useEffect((()=>{T&&P.current(j.current,M.current)}),[T]),e.useEffect((()=>{!O&&!T&&S()}),[O,T,S]),n.default.createElement(H,{width:y,height:g,isEditorReady:T,loading:d,_ref:k,className:h,wrapperProps:v})}Z.propTypes={original:r.propTypes.exports.string,modified:r.propTypes.exports.string,language:r.propTypes.exports.string,originalLanguage:r.propTypes.exports.string,modifiedLanguage:r.propTypes.exports.string,originalModelPath:r.propTypes.exports.string,modifiedModelPath:r.propTypes.exports.string,keepCurrentOriginalModel:r.propTypes.exports.bool,keepCurrentModifiedModel:r.propTypes.exports.bool,theme:r.propTypes.exports.string,loading:r.propTypes.exports.oneOfType([r.propTypes.exports.element,r.propTypes.exports.string]),options:r.propTypes.exports.object,width:r.propTypes.exports.oneOfType([r.propTypes.exports.number,r.propTypes.exports.string]),height:r.propTypes.exports.oneOfType([r.propTypes.exports.number,r.propTypes.exports.string]),className:r.propTypes.exports.string,wrapperProps:r.propTypes.exports.object,beforeMount:r.propTypes.exports.func,onMount:r.propTypes.exports.func},Z.defaultProps={theme:"light",loading:"Loading...",options:{},keepCurrentOriginalModel:!1,keepCurrentModifiedModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:Q,onMount:Q};const ee=new Map;function re({defaultValue:r,defaultLanguage:t,defaultPath:o,value:i,language:a,path:u,theme:s,line:c,loading:p,options:l,overrideServices:d,saveViewState:f,keepCurrentModel:g,width:y,height:h,className:v,wrapperProps:m,beforeMount:b,onMount:T,onChange:w,onValidate:O}){const[x,j]=e.useState(!1),[M,k]=e.useState(!0),P=e.useRef(null),E=e.useRef(null),R=e.useRef(null),S=e.useRef(T),C=e.useRef(b),q=e.useRef(null),V=e.useRef(i),I=function(r){const t=e.useRef();return e.useEffect((()=>{t.current=r}),[r]),t.current}(u);J((()=>{const e=D.init();return e.then((e=>(P.current=e)&&k(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&console.error("Monaco initialization: error:",e))),()=>E.current?function(){var e,r;null===(e=q.current)||void 0===e||e.dispose(),g?f&&ee.set(u,E.current.saveViewState()):null===(r=E.current.getModel())||void 0===r||r.dispose();E.current.dispose()}():e.cancel()})),K((()=>{const e=W(P.current,r||i,t||a,u);e!==E.current.getModel()&&(f&&ee.set(I,E.current.saveViewState()),E.current.setModel(e),f&&E.current.restoreViewState(ee.get(u)))}),[u],x),K((()=>{E.current.updateOptions(l)}),[l],x),K((()=>{E.current.getOption(P.current.editor.EditorOption.readOnly)?E.current.setValue(i):i!==E.current.getValue()&&(E.current.executeEdits("",[{range:E.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),E.current.pushUndoStop())}),[i],x),K((()=>{P.current.editor.setModelLanguage(E.current.getModel(),a)}),[a],x),K((()=>{void 0!==c&&E.current.revealLine(c)}),[c],x),K((()=>{P.current.editor.setTheme(s)}),[s],x);const N=e.useCallback((()=>{C.current(P.current);const e=u||o,n=W(P.current,i||r,t||a,e);E.current=P.current.editor.create(R.current,{model:n,automaticLayout:!0,...l},d),f&&E.current.restoreViewState(ee.get(e)),P.current.editor.setTheme(s),j(!0)}),[r,t,o,i,a,u,l,d,f,s]);return e.useEffect((()=>{x&&S.current(E.current,P.current)}),[x]),e.useEffect((()=>{!M&&!x&&N()}),[M,x,N]),V.current=i,e.useEffect((()=>{var e,r;x&&w&&(null===(e=q.current)||void 0===e||e.dispose(),q.current=null===(r=E.current)||void 0===r?void 0:r.onDidChangeModelContent((e=>{const r=E.current.getValue();V.current!==r&&w(r,e)})))}),[x,w]),e.useEffect((()=>{if(x){const e=P.current.editor.onDidChangeMarkers((e=>{var r;const t=null===(r=E.current.getModel())||void 0===r?void 0:r.uri;if(t){if(e.find((e=>e.path===t.path))){const e=P.current.editor.getModelMarkers({resource:t});null==O||O(e)}}}));return()=>{null==e||e.dispose()}}}),[x,O]),n.default.createElement(H,{width:y,height:h,isEditorReady:x,loading:p,_ref:R,className:v,wrapperProps:m})}re.propTypes={defaultValue:r.propTypes.exports.string,defaultPath:r.propTypes.exports.string,defaultLanguage:r.propTypes.exports.string,value:r.propTypes.exports.string,language:r.propTypes.exports.string,path:r.propTypes.exports.string,theme:r.propTypes.exports.string,line:r.propTypes.exports.number,loading:r.propTypes.exports.oneOfType([r.propTypes.exports.element,r.propTypes.exports.string]),options:r.propTypes.exports.object,overrideServices:r.propTypes.exports.object,saveViewState:r.propTypes.exports.bool,keepCurrentModel:r.propTypes.exports.bool,width:r.propTypes.exports.oneOfType([r.propTypes.exports.number,r.propTypes.exports.string]),height:r.propTypes.exports.oneOfType([r.propTypes.exports.number,r.propTypes.exports.string]),className:r.propTypes.exports.string,wrapperProps:r.propTypes.exports.object,beforeMount:r.propTypes.exports.func,onMount:r.propTypes.exports.func,onChange:r.propTypes.exports.func,onValidate:r.propTypes.exports.func},re.defaultProps={theme:"light",loading:"Loading...",options:{},overrideServices:{},saveViewState:!0,keepCurrentModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:Q,onMount:Q,onValidate:Q};var te=e.memo(re);function ne(e,r){const t=function(e){return void 0===e?{}:{"editor.background":e.components.input.background,"minimap.background":e.colors.background.secondary}}(r);e.editor.defineTheme("grafana-dark",{base:"vs-dark",inherit:!0,colors:t,rules:[{token:"predefined",foreground:null==r?void 0:r.visualization.getColorByName("purple")},{token:"operator",foreground:null==r?void 0:r.visualization.getColorByName("orange")},{token:"tag",foreground:null==r?void 0:r.visualization.getColorByName("green")}]}),e.editor.defineTheme("grafana-light",{base:"vs",inherit:!0,colors:t,rules:[{token:"predefined",foreground:null==r?void 0:r.visualization.getColorByName("purple")},{token:"operator",foreground:null==r?void 0:r.visualization.getColorByName("orange")},{token:"tag",foreground:null==r?void 0:r.visualization.getColorByName("green")}]})}let oe=!1;exports.ReactMonacoEditor=t=>{const o=r.useTheme2(),i=function(){const[r,t]=e.useState(D.__getMonacoInstance());return J((()=>{let e;return r||(e=D.init(),e.then((e=>{t(e)}))),()=>{var r;return null===(r=e)||void 0===r?void 0:r.cancel()}})),r}();var a;e.useEffect((()=>{null!==i&&ne(i,o)}),[i,o]),oe||(D.config({paths:{vs:(null!==(a=window.__grafana_public_path__)&&void 0!==a?a:"public/")+"lib/monaco/min/vs"}}),oe=!0,D.init().then((e=>{ne(e)})));const u=o.isDark?"grafana-dark":"grafana-light";return n.default.createElement(te,Object.assign({theme:u},t))};
//# sourceMappingURL=ReactMonacoEditor.production.js.map
