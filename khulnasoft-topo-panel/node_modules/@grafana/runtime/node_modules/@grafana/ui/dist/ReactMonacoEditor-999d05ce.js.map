{"version":3,"file":"ReactMonacoEditor-999d05ce.js","sources":["../src/components/Monaco/theme.ts","../src/components/Monaco/ReactMonacoEditor.tsx"],"sourcesContent":["import { GrafanaTheme2 } from '@grafana/data';\n\nimport { Monaco, monacoTypes } from './types';\n\nfunction getColors(theme?: GrafanaTheme2): monacoTypes.editor.IColors {\n  if (theme === undefined) {\n    return {};\n  } else {\n    return {\n      'editor.background': theme.components.input.background,\n      'minimap.background': theme.colors.background.secondary,\n    };\n  }\n}\n\n// we support calling this without a theme, it will make sure the themes\n// are registered in monaco, even if the colors are not perfect.\nexport default function defineThemes(monaco: Monaco, theme?: GrafanaTheme2) {\n  // color tokens are defined here https://github.com/microsoft/vscode/blob/main/src/vs/platform/theme/common/colorRegistry.ts#L174\n  const colors = getColors(theme);\n  monaco.editor.defineTheme('grafana-dark', {\n    base: 'vs-dark',\n    inherit: true,\n    colors: colors,\n    // fallback syntax highlighting for languages that microsoft doesn't handle (ex cloudwatch's metric math)\n    rules: [\n      { token: 'predefined', foreground: theme?.visualization.getColorByName('purple') },\n      { token: 'operator', foreground: theme?.visualization.getColorByName('orange') },\n      { token: 'tag', foreground: theme?.visualization.getColorByName('green') },\n    ],\n  });\n\n  monaco.editor.defineTheme('grafana-light', {\n    base: 'vs',\n    inherit: true,\n    colors: colors,\n    // fallback syntax highlighting for languages that microsoft doesn't handle (ex cloudwatch's metric math)\n    rules: [\n      { token: 'predefined', foreground: theme?.visualization.getColorByName('purple') },\n      { token: 'operator', foreground: theme?.visualization.getColorByName('orange') },\n      { token: 'tag', foreground: theme?.visualization.getColorByName('green') },\n    ],\n  });\n}\n","import MonacoEditor, { loader as monacoEditorLoader, useMonaco } from '@monaco-editor/react';\nimport React, { useEffect } from 'react';\n\nimport { useTheme2 } from '../../themes';\n\nimport defineThemes from './theme';\nimport type { ReactMonacoEditorProps } from './types';\n\nlet initalized = false;\nfunction initMonaco() {\n  if (initalized) {\n    return;\n  }\n\n  monacoEditorLoader.config({\n    paths: {\n      vs: (window.__grafana_public_path__ ?? 'public/') + 'lib/monaco/min/vs',\n    },\n  });\n  initalized = true;\n  monacoEditorLoader.init().then((monaco) => {\n    // this call makes sure the themes exist.\n    // they will not have the correct colors,\n    // but we need them to exist since the beginning,\n    // because if we start a monaco instance with\n    // a theme that does not exist, it will not work well.\n    defineThemes(monaco);\n  });\n}\n\nexport const ReactMonacoEditor = (props: ReactMonacoEditorProps) => {\n  const theme = useTheme2();\n  const monaco = useMonaco();\n\n  useEffect(() => {\n    // monaco can be null or undefined at the beginning, because it is loaded in asynchronously\n    if (monaco != null) {\n      defineThemes(monaco, theme);\n    }\n  }, [monaco, theme]);\n\n  initMonaco();\n\n  const monacoTheme = theme.isDark ? 'grafana-dark' : 'grafana-light';\n\n  return <MonacoEditor theme={monacoTheme} {...props} />;\n};\n"],"names":["monacoEditorLoader","useTheme2","useMonaco","useEffect","React","MonacoEditor"],"mappings":"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"}