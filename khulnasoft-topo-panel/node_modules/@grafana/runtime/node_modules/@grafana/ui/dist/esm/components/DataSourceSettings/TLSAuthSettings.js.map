{"version":3,"file":"TLSAuthSettings.js","sources":["../../../../src/components/DataSourceSettings/TLSAuthSettings.tsx"],"sourcesContent":["import { css, cx } from '@emotion/css';\nimport React from 'react';\n\nimport { KeyValue } from '@grafana/data';\n\nimport { FormField } from '../FormField/FormField';\nimport { Icon } from '../Icon/Icon';\nimport { Tooltip } from '../Tooltip/Tooltip';\n\nimport { CertificationKey } from './CertificationKey';\nimport { HttpSettingsBaseProps } from './types';\n\nexport const TLSAuthSettings: React.FC<HttpSettingsBaseProps> = ({ dataSourceConfig, onChange }) => {\n  const hasTLSCACert = dataSourceConfig.secureJsonFields && dataSourceConfig.secureJsonFields.tlsCACert;\n  const hasTLSClientCert = dataSourceConfig.secureJsonFields && dataSourceConfig.secureJsonFields.tlsClientCert;\n  const hasTLSClientKey = dataSourceConfig.secureJsonFields && dataSourceConfig.secureJsonFields.tlsClientKey;\n  const hasServerName = dataSourceConfig.jsonData && dataSourceConfig.jsonData.serverName;\n\n  const onResetClickFactory = (field: string) => (event: React.MouseEvent<HTMLButtonElement>) => {\n    event.preventDefault();\n    const newSecureJsonFields: KeyValue<boolean> = { ...dataSourceConfig.secureJsonFields };\n    newSecureJsonFields[field] = false;\n    onChange({\n      ...dataSourceConfig,\n      secureJsonFields: newSecureJsonFields,\n    });\n  };\n\n  const onCertificateChangeFactory = (field: string) => (event: React.SyntheticEvent<HTMLTextAreaElement>) => {\n    const newSecureJsonData = { ...dataSourceConfig.secureJsonData };\n    newSecureJsonData[field] = event.currentTarget.value;\n\n    onChange({\n      ...dataSourceConfig,\n      secureJsonData: newSecureJsonData,\n    });\n  };\n\n  const onServerNameLabelChange = (event: React.SyntheticEvent<HTMLInputElement>) => {\n    const newJsonData = {\n      ...dataSourceConfig.jsonData,\n      serverName: event.currentTarget.value,\n    };\n\n    onChange({\n      ...dataSourceConfig,\n      jsonData: newJsonData,\n    });\n  };\n\n  return (\n    <div className=\"gf-form-group\">\n      <div\n        className={cx(\n          'gf-form',\n          css`\n            align-items: baseline;\n          `\n        )}\n      >\n        <h6>TLS/SSL Auth Details</h6>\n        <Tooltip\n          placement=\"right-end\"\n          content=\"TLS/SSL Certs are encrypted and stored in the Grafana database.\"\n          theme=\"info\"\n        >\n          <div className=\"gf-form-help-icon gf-form-help-icon--right-normal\">\n            <Icon name=\"info-circle\" size=\"xs\" style={{ marginLeft: '10px' }} />\n          </div>\n        </Tooltip>\n      </div>\n      <div>\n        {dataSourceConfig.jsonData.tlsAuthWithCACert && (\n          <CertificationKey\n            hasCert={!!hasTLSCACert}\n            onChange={onCertificateChangeFactory('tlsCACert')}\n            placeholder=\"Begins with -----BEGIN CERTIFICATE-----\"\n            label=\"CA Cert\"\n            onClick={onResetClickFactory('tlsCACert')}\n          />\n        )}\n\n        {dataSourceConfig.jsonData.tlsAuth && (\n          <>\n            <div className=\"gf-form\">\n              <FormField\n                label=\"ServerName\"\n                labelWidth={7}\n                inputWidth={30}\n                placeholder=\"domain.example.com\"\n                value={hasServerName && dataSourceConfig.jsonData.serverName}\n                onChange={onServerNameLabelChange}\n              />\n            </div>\n            <CertificationKey\n              hasCert={!!hasTLSClientCert}\n              label=\"Client Cert\"\n              onChange={onCertificateChangeFactory('tlsClientCert')}\n              placeholder=\"Begins with -----BEGIN CERTIFICATE-----\"\n              onClick={onResetClickFactory('tlsClientCert')}\n            />\n\n            <CertificationKey\n              hasCert={!!hasTLSClientKey}\n              label=\"Client Key\"\n              placeholder=\"Begins with -----BEGIN RSA PRIVATE KEY-----\"\n              onChange={onCertificateChangeFactory('tlsClientKey')}\n              onClick={onResetClickFactory('tlsClientKey')}\n            />\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n"],"names":["React"],"mappings":"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"}