{"version":3,"file":"TimeRangeInput.js","sources":["../../../../src/components/DateTimePickers/TimeRangeInput.tsx"],"sourcesContent":["import { css, cx } from '@emotion/css';\nimport React, { FC, FormEvent, MouseEvent, useState } from 'react';\n\nimport { dateMath, dateTime, getDefaultTimeRange, GrafanaTheme2, TimeRange, TimeZone } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\n\nimport { stylesFactory } from '../../themes';\nimport { useTheme2 } from '../../themes/ThemeContext';\nimport { ClickOutsideWrapper } from '../ClickOutsideWrapper/ClickOutsideWrapper';\nimport { Icon } from '../Icon/Icon';\nimport { getInputStyles } from '../Input/Input';\n\nimport { TimePickerButtonLabel } from './TimeRangePicker';\nimport { TimePickerContent } from './TimeRangePicker/TimePickerContent';\nimport { quickOptions } from './options';\n\nconst isValidTimeRange = (range: TimeRange) => {\n  return dateMath.isValid(range.from) && dateMath.isValid(range.to);\n};\n\nexport interface TimeRangeInputProps {\n  value: TimeRange;\n  timeZone?: TimeZone;\n  onChange: (timeRange: TimeRange) => void;\n  onChangeTimeZone?: (timeZone: TimeZone) => void;\n  hideTimeZone?: boolean;\n  placeholder?: string;\n  clearable?: boolean;\n  /** Controls horizontal alignment of the picker menu */\n  isReversed?: boolean;\n  /** Controls visibility of the preset time ranges (e.g. **Last 5 minutes**) in the picker menu */\n  hideQuickRanges?: boolean;\n  disabled?: boolean;\n}\n\nconst noop = () => {};\n\nexport const TimeRangeInput: FC<TimeRangeInputProps> = ({\n  value,\n  onChange,\n  onChangeTimeZone = noop,\n  clearable,\n  hideTimeZone = true,\n  timeZone = 'browser',\n  placeholder = 'Select time range',\n  isReversed = true,\n  hideQuickRanges = false,\n  disabled = false,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const theme = useTheme2();\n  const styles = getStyles(theme, disabled);\n\n  const onOpen = (event: FormEvent<HTMLButtonElement>) => {\n    event.stopPropagation();\n    event.preventDefault();\n    if (disabled) {\n      return;\n    }\n    setIsOpen(!isOpen);\n  };\n\n  const onClose = () => {\n    setIsOpen(false);\n  };\n\n  const onRangeChange = (timeRange: TimeRange) => {\n    onClose();\n    onChange(timeRange);\n  };\n\n  const onRangeClear = (event: MouseEvent<HTMLDivElement>) => {\n    event.stopPropagation();\n    const from = dateTime(null);\n    const to = dateTime(null);\n    onChange({ from, to, raw: { from, to } });\n  };\n\n  return (\n    <div className={styles.container}>\n      <button\n        type=\"button\"\n        className={styles.pickerInput}\n        aria-label={selectors.components.TimePicker.openButton}\n        onClick={onOpen}\n      >\n        {isValidTimeRange(value) ? (\n          <TimePickerButtonLabel value={value} timeZone={timeZone} />\n        ) : (\n          <span className={styles.placeholder}>{placeholder}</span>\n        )}\n\n        {!disabled && (\n          <span className={styles.caretIcon}>\n            {isValidTimeRange(value) && clearable && (\n              <Icon className={styles.clearIcon} name=\"times\" size=\"lg\" onClick={onRangeClear} />\n            )}\n            <Icon name={isOpen ? 'angle-up' : 'angle-down'} size=\"lg\" />\n          </span>\n        )}\n      </button>\n      {isOpen && (\n        <ClickOutsideWrapper includeButtonPress={false} onClick={onClose}>\n          <TimePickerContent\n            timeZone={timeZone}\n            value={isValidTimeRange(value) ? value : getDefaultTimeRange()}\n            onChange={onRangeChange}\n            quickOptions={quickOptions}\n            onChangeTimeZone={onChangeTimeZone}\n            className={styles.content}\n            hideTimeZone={hideTimeZone}\n            isReversed={isReversed}\n            hideQuickRanges={hideQuickRanges}\n          />\n        </ClickOutsideWrapper>\n      )}\n    </div>\n  );\n};\n\nconst getStyles = stylesFactory((theme: GrafanaTheme2, disabled = false) => {\n  const inputStyles = getInputStyles({ theme, invalid: false });\n  return {\n    container: css`\n      display: flex;\n      position: relative;\n    `,\n    content: css`\n      margin-left: 0;\n    `,\n    pickerInput: cx(\n      inputStyles.input,\n      disabled && inputStyles.inputDisabled,\n      inputStyles.wrapper,\n      css`\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        cursor: pointer;\n        padding-right: 0;\n        line-height: ${theme.spacing.gridSize * 4 - 2}px;\n      `\n    ),\n    caretIcon: cx(\n      inputStyles.suffix,\n      css`\n        position: relative;\n        top: -1px;\n        margin-left: ${theme.spacing(0.5)};\n      `\n    ),\n    clearIcon: css`\n      margin-right: ${theme.spacing(0.5)};\n      &:hover {\n        color: ${theme.colors.text.maxContrast};\n      }\n    `,\n    placeholder: css`\n      color: ${theme.colors.text.disabled};\n      opacity: 1;\n    `,\n  };\n});\n"],"names":["React"],"mappings":"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"}