{"version":3,"file":"BarGaugeCell.js","sources":["../../../../src/components/Table/BarGaugeCell.tsx"],"sourcesContent":["import { isFunction } from 'lodash';\nimport React, { FC } from 'react';\n\nimport { ThresholdsConfig, ThresholdsMode, VizOrientation, getFieldConfigWithMinMax } from '@grafana/data';\n\nimport { BarGauge, BarGaugeDisplayMode } from '../BarGauge/BarGauge';\nimport { DataLinksContextMenu, DataLinksContextMenuApi } from '../DataLinks/DataLinksContextMenu';\n\nimport { TableCellProps, TableCellDisplayMode } from './types';\n\nconst defaultScale: ThresholdsConfig = {\n  mode: ThresholdsMode.Absolute,\n  steps: [\n    {\n      color: 'blue',\n      value: -Infinity,\n    },\n    {\n      color: 'green',\n      value: 20,\n    },\n  ],\n};\n\nexport const BarGaugeCell: FC<TableCellProps> = (props) => {\n  const { field, innerWidth, tableStyles, cell, cellProps, row } = props;\n\n  let config = getFieldConfigWithMinMax(field, false);\n  if (!config.thresholds) {\n    config = {\n      ...config,\n      thresholds: defaultScale,\n    };\n  }\n\n  const displayValue = field.display!(cell.value);\n  let barGaugeMode = BarGaugeDisplayMode.Gradient;\n\n  if (field.config.custom && field.config.custom.displayMode === TableCellDisplayMode.LcdGauge) {\n    barGaugeMode = BarGaugeDisplayMode.Lcd;\n  } else if (field.config.custom && field.config.custom.displayMode === TableCellDisplayMode.BasicGauge) {\n    barGaugeMode = BarGaugeDisplayMode.Basic;\n  }\n\n  const getLinks = () => {\n    if (!isFunction(field.getLinks)) {\n      return [];\n    }\n\n    return field.getLinks({ valueRowIndex: row.index });\n  };\n\n  const hasLinks = Boolean(getLinks().length);\n\n  const renderComponent = (menuProps: DataLinksContextMenuApi) => {\n    const { openMenu, targetClassName } = menuProps;\n\n    return (\n      <BarGauge\n        width={innerWidth}\n        height={tableStyles.cellHeightInner}\n        field={config}\n        display={field.display}\n        text={{ valueSize: 14 }}\n        value={displayValue}\n        orientation={VizOrientation.Horizontal}\n        theme={tableStyles.theme}\n        onClick={openMenu}\n        className={targetClassName}\n        itemSpacing={1}\n        lcdCellWidth={8}\n        displayMode={barGaugeMode}\n      />\n    );\n  };\n\n  return (\n    <div {...cellProps} className={tableStyles.cellContainer}>\n      {hasLinks && (\n        <DataLinksContextMenu links={getLinks} style={{ display: 'flex', width: '100%' }}>\n          {(api) => renderComponent(api)}\n        </DataLinksContextMenu>\n      )}\n      {!hasLinks && (\n        <BarGauge\n          width={innerWidth}\n          height={tableStyles.cellHeightInner}\n          field={config}\n          display={field.display}\n          text={{ valueSize: 14 }}\n          value={displayValue}\n          orientation={VizOrientation.Horizontal}\n          theme={tableStyles.theme}\n          itemSpacing={1}\n          lcdCellWidth={8}\n          displayMode={barGaugeMode}\n        />\n      )}\n    </div>\n  );\n};\n"],"names":["React"],"mappings":"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"}